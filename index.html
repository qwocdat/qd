<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP KEY SYSTEM</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root { --main: #00ff88; --bg: #090909; --card: #151515; }
        * { margin:0; padding:0; box-sizing:border-box; }
        body { background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        
        .container { 
            width: 380px; padding: 30px; background: var(--card); border-radius: 20px; 
            border: 1px solid #333; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.5); 
            position: relative;
        }
        
        h2 { color: var(--main); font-family: 'Orbitron'; margin-bottom: 5px; }
        p { color: #888; font-size: 13px; margin-bottom: 25px; }
        
        .btn {
            width: 100%; padding: 15px; border: none; border-radius: 10px;
            font-weight: bold; font-size: 16px; cursor: pointer; margin-top: 10px;
            transition: 0.3s; text-transform: uppercase;
        }
        
        .btn-link { background: #333; color: #fff; border: 1px solid #444; }
        .btn-link:hover { background: #444; }
        
        .btn-gen { background: var(--main); color: #000; box-shadow: 0 0 15px rgba(0, 255, 136, 0.3); }
        .btn-gen:hover { transform: scale(1.02); }

        .key-area { display: none; margin-top: 20px; }
        .key-box { 
            background: #000; border: 2px dashed var(--main); color: var(--main); 
            font-family: 'Orbitron'; font-size: 28px; padding: 15px; 
            border-radius: 8px; margin-bottom: 10px; letter-spacing: 2px;
        }
        .timer { font-size: 14px; color: #aaa; }
        #step1, #step2 { display: none; }
        .loading { font-size: 12px; color: #ffff00; margin-top: 5px; display: none; }
    </style>
</head>
<body>

    <div class="container">
        <h2>H·ªÜ TH·ªêNG VIP</h2>
        <p>T·ª± ƒë·ªông t·∫°o link - API Link4M</p>

        <div id="step1">
            <button class="btn btn-link" onclick="getLink4M()">üëâ B·∫§M ƒê·ªÇ L·∫§Y LINK KEY</button>
            <div id="loadingMsg" class="loading">ƒêang k·∫øt n·ªëi t·ªõi Link4M... vui l√≤ng ch·ªù...</div>
        </div>

        <div id="step2">
            <div style="color:#00ff88; margin-bottom:15px; font-weight:bold;">‚úÖ X√°c minh th√†nh c√¥ng!</div>
            <button class="btn btn-gen" onclick="startGen()">KH·ªûI T·∫†O KEY NGAY</button>
        </div>

        <div id="keyDisplayArea" class="key-area">
            <div class="key-box" id="finalKey">LOADING...</div>
            <div class="timer">ƒê·ªïi sau: <span id="timeCount" style="color:#fff">--</span>s</div>
            <button class="btn btn-link" onclick="copyKey()" style="margin-top:15px; font-size:12px;">Sao ch√©p</button>
        </div>
    </div>

    <script>
        // ===========================================
        // C·∫§U H√åNH API LINK4M
        const SECRET = "QUOC_DAT_SECRET_KEY_2026"; 
        const API_TOKEN = "6992df868b3d1e423d1ab833"; // API C·ªßa b·∫°n
        // ===========================================

        // Ki·ªÉm tra URL xem ƒë√£ v∆∞·ª£t link ch∆∞a
        const urlParams = new URLSearchParams(window.location.search);
        const isVerified = urlParams.get('verify') === 'true';

        if (isVerified) {
            document.getElementById('step2').style.display = 'block';
        } else {
            document.getElementById('step1').style.display = 'block';
        }

        async function getLink4M() {
            const btn = document.querySelector('.btn-link');
            const msg = document.getElementById('loadingMsg');
            
            btn.disabled = true;
            btn.innerText = "ƒêANG T·∫†O LINK...";
            msg.style.display = 'block';

            // T·∫°o URL ƒë√≠ch (Link web hi·ªán t·∫°i + ?verify=true)
            // Lo·∫°i b·ªè c√°c tham s·ªë c≈© n·∫øu c√≥ ƒë·ªÉ tr√°nh l·ªói
            const currentUrl = window.location.href.split('?')[0]; 
            const targetUrl = encodeURIComponent(currentUrl + "?verify=true");

            // G·ªçi API Link4M
            try {
                const response = await fetch(`https://link4m.com/api-shorten/v2?api=${API_TOKEN}&url=${targetUrl}`);
                const data = await response.json();

                if (data.status === "success") {
                    // Chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng ƒë·∫øn link r√∫t g·ªçn
                    window.location.href = data.shortenedUrl;
                } else {
                    alert("L·ªói t·∫°o link: " + data.message);
                    btn.disabled = false;
                    btn.innerText = "üëâ B·∫§M ƒê·ªÇ L·∫§Y LINK KEY";
                    msg.style.display = 'none';
                }
            } catch (error) {
                console.error(error);
                // N·∫øu fetch l·ªói (do CORS), th·ª≠ c√°ch chuy·ªÉn h∆∞·ªõng tr·ª±c ti·∫øp
                // ƒê√¢y l√† ph∆∞∆°ng √°n d·ª± ph√≤ng
                alert("ƒêang th·ª≠ ph∆∞∆°ng th·ª©c k·∫øt n·ªëi d·ª± ph√≤ng...");
                window.location.href = `https://link4m.com/api?api=${API_TOKEN}&url=${targetUrl}`;
            }
        }

        let interval;
        function startGen() {
            document.getElementById('step2').style.display = 'none';
            document.getElementById('keyDisplayArea').style.display = 'block';
            updateKey();
            interval = setInterval(updateKey, 1000);
        }

        function updateKey() {
            const now = Math.floor(Date.now() / 1000);
            const duration = 180; 
            const timeStep = Math.floor(now / duration);
            
            const raw = SECRET + timeStep;
            const hash = CryptoJS.MD5(raw).toString();
            const num = parseInt(hash.substring(0, 8), 16) % 10000;
            const key = "dat_" + num.toString().padStart(4, '0');
            
            document.getElementById("finalKey").innerText = key;
            document.getElementById("timeCount").innerText = duration - (now % duration);
        }

        function copyKey() {
            const k = document.getElementById("finalKey").innerText;
            navigator.clipboard.writeText(k);
            alert("ƒê√£ sao ch√©p: " + k);
        }
    </script>
</body>
</html>
