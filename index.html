<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sunwin Vip - Mobile & PC Optimized</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* --- 1. RESET & CORE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0;
            background: #1a0505;
            font-family: 'Roboto', sans-serif;
            color: #fff;
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* --- 2. LAYOUT CH√çNH (DESKTOP FIRST) --- */
        .app-container {
            display: flex;
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* KHU V·ª∞C GAME (B√äN TR√ÅI) */
        .game-area {
            flex: 1;
            background: radial-gradient(circle at center, #3a0e0e 0%, #000 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0 20px 0;
            position: relative;
            transition: 0.3s;
        }

        /* KHU V·ª∞C TOOL (B√äN PH·∫¢I) */
        .tool-panel {
            width: 320px;
            background: #0d0d0d;
            border-left: 2px solid #00ff00;
            display: flex;
            flex-direction: column;
            padding: 15px;
            font-family: 'Share Tech Mono', monospace;
            z-index: 100;
            transition: transform 0.3s ease-in-out;
            position: relative;
        }

        /* N√∫t Toggle Tool (Ch·ªâ hi·ªán khi c·∫ßn ho·∫∑c mobile) */
        .toggle-tool-btn {
            position: absolute;
            top: 50%;
            left: -40px; /* N·∫±m ngo√†i panel */
            width: 40px;
            height: 80px;
            background: #00ff00;
            color: #000;
            border: none;
            border-radius: 10px 0 0 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            writing-mode: vertical-rl;
            font-weight: bold;
            box-shadow: -5px 0 10px rgba(0,255,0,0.3);
            z-index: 101;
        }

        /* --- 3. GAME COMPONENTS --- */
        
        /* Header ti·ªÅn */
        .balance-bar {
            background: linear-gradient(180deg, #2c3e50, #000);
            border: 2px solid #d4af37;
            padding: 8px 25px;
            border-radius: 25px;
            font-size: 20px;
            color: #f1c40f;
            box-shadow: 0 0 10px #d4af37;
            font-weight: 900;
            margin-top: 10px;
        }

        /* B√†n ch∆°i (C·ª≠a + B√°t) */
        .board {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            width: 100%;
            flex-grow: 1; /* Chi·∫øm kho·∫£ng tr·ªëng */
        }

        /* C·ª≠a ƒë·∫∑t */
        .gate {
            width: 160px; height: 160px;
            background: linear-gradient(180deg, #4b0d0d, #220505);
            border: 2px solid #6e4618;
            border-radius: 15px;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            cursor: pointer; position: relative;
            transition: 0.2s;
        }
        .gate.active { box-shadow: 0 0 25px #f1c40f; border-color: #f1c40f; transform: scale(1.05); }
        .gate-title { font-size: 40px; font-weight: 900; line-height: 1; }
        .txt-tai { color: white; -webkit-text-stroke: 1px #d4af37; }
        .txt-xiu { color: white; -webkit-text-stroke: 1px #bdc3c7; }
        .my-bet { 
            background: rgba(0,0,0,0.7); padding: 2px 8px; border-radius: 4px; 
            color: #2ecc71; margin-top: 5px; font-size: 14px; font-weight: bold;
        }

        /* ƒêƒ©a quay (Center) */
        .plate {
            width: 220px; height: 220px;
            background: radial-gradient(circle, #5e4018 0%, #1f1302 100%);
            border-radius: 50%; border: 6px solid #d4af37;
            display: flex; justify-content: center; align-items: center;
            position: relative;
        }
        
        .timer {
            position: absolute; top: -30px;
            width: 50px; height: 50px;
            background: #000; border: 3px solid #e74c3c;
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-size: 24px; color: #e74c3c; font-weight: bold; z-index: 20;
            box-shadow: 0 0 10px #e74c3c;
        }

        .dice-grp { display: flex; gap: 8px; }
        .dice {
            width: 45px; height: 45px; background: #fff;
            border-radius: 8px; font-size: 32px;
            display: flex; justify-content: center; align-items: center;
            color: #c0392b; box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
        }

        .bowl {
            position: absolute; width: 190px; height: 190px;
            background: radial-gradient(circle at 30% 30%, #ffd700, #b8860b, #5e4018);
            border-radius: 50%; z-index: 10;
            display: flex; justify-content: center; align-items: center;
            transition: transform 0.5s ease-out, opacity 0.5s;
            box-shadow: 0 5px 20px rgba(0,0,0,0.8);
        }
        .bowl.open { transform: translateY(-120px); opacity: 0; pointer-events: none; }
        
        .shaking { animation: shake 0.4s infinite; }
        @keyframes shake {
            0% { transform: translate(0,0) rotate(0); }
            25% { transform: translate(-3px, 3px) rotate(-3deg); }
            75% { transform: translate(3px, -3px) rotate(3deg); }
            100% { transform: translate(0,0) rotate(0); }
        }

        /* Controls (Chip & N√∫t) */
        .controls { display: flex; flex-direction: column; align-items: center; gap: 8px; width: 100%; }
        .status { color: #f39c12; font-weight: bold; font-size: 14px; min-height: 20px; }
        
        .chips { display: flex; gap: 10px; margin-bottom: 5px; }
        .chip {
            width: 45px; height: 45px; border-radius: 50%;
            background: url('https://i.imgur.com/example.png'), radial-gradient(circle, #e67e22, #d35400);
            border: 2px dashed #fff; display: flex; justify-content: center; align-items: center;
            cursor: pointer; font-size: 10px; font-weight: bold; text-align: center;
            box-shadow: 0 3px 0 #a04000;
        }
        .chip:active { transform: scale(0.95); box-shadow: none; }

        .btn-confirm {
            background: linear-gradient(to bottom, #f1c40f, #f39c12);
            border: none; padding: 12px 50px; border-radius: 30px;
            color: #2d3436; font-weight: 900; font-size: 16px;
            cursor: pointer; box-shadow: 0 0 15px rgba(241, 196, 15, 0.4);
            text-transform: uppercase;
        }
        .btn-confirm:disabled { filter: grayscale(1); cursor: not-allowed; }

        /* Soi C·∫ßu */
        .roadmap {
            width: 95%; height: 40px;
            background: rgba(0,0,0,0.5); border-radius: 20px;
            display: flex; align-items: center; padding: 0 10px;
            overflow-x: auto; margin-bottom: 10px; border: 1px solid #444;
        }
        .dot {
            width: 18px; height: 18px; border-radius: 50%;
            margin-right: 5px; flex-shrink: 0; font-size: 9px;
            display: flex; justify-content: center; align-items: center;
        }
        .d-tai { background: #9b59b6; } .d-xiu { background: #2ecc71; }

        /* --- 4. TOOL STYLES --- */
        .tool-header { color: #00ff00; text-align: center; border-bottom: 1px dashed #00ff00; padding-bottom: 10px; margin-bottom: 15px; font-size: 18px;}
        .log-box {
            background: #000; flex: 1; border: 1px solid #333;
            padding: 8px; font-size: 11px; color: #00ff00;
            overflow-y: auto; margin-bottom: 15px; font-family: monospace;
        }
        .result-box {
            border: 1px solid #00ff00; padding: 10px; text-align: center;
            margin-bottom: 15px; background: #050505;
        }
        .res-text { font-size: 28px; font-weight: bold; margin: 5px 0; }
        .res-tai { color: #e74c3c; text-shadow: 0 0 8px red; } 
        .res-xiu { color: #3498db; text-shadow: 0 0 8px blue; }
        
        .tool-btn {
            background: transparent; border: 1px solid #00ff00; color: #00ff00;
            padding: 10px; width: 100%; margin-bottom: 8px; cursor: pointer;
            font-family: 'Share Tech Mono'; transition: 0.2s;
        }
        .tool-btn:hover { background: #00ff00; color: #000; }
        .tool-btn:disabled { border-color: #555; color: #555; pointer-events: none; }

        .win-msg {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            font-size: 50px; color: #f1c40f; text-shadow: 0 0 20px red;
            display: none; z-index: 50; font-weight: 900; animation: popIn 0.5s;
        }
        @keyframes popIn { from {transform: translate(-50%, -50%) scale(0);} to {transform: translate(-50%, -50%) scale(1);} }

        /* --- 5. RESPONSIVE MOBILE (QUAN TR·ªåNG) --- */
        @media (max-width: 768px) {
            .app-container { flex-direction: column; }
            
            /* Thu nh·ªè b√†n ch∆°i */
            .gate { width: 100px; height: 100px; }
            .gate-title { font-size: 28px; }
            .plate { width: 160px; height: 160px; }
            .bowl { width: 140px; height: 140px; }
            .dice { width: 35px; height: 35px; font-size: 24px; }
            .game-board { gap: 5px; }
            
            /* Tool Panel chuy·ªÉn th√†nh Drawer (Tr∆∞·ª£t t·ª´ d∆∞·ªõi l√™n) */
            .tool-panel {
                position: fixed;
                bottom: 0; left: 0; width: 100%; height: 60%;
                border-left: none; border-top: 2px solid #00ff00;
                transform: translateY(110%); /* ·∫®n ƒëi */
                box-shadow: 0 -5px 20px rgba(0,0,0,0.8);
            }
            .tool-panel.active { transform: translateY(0); }

            /* N√∫t m·ªü tool tr√™n mobile (Floating Action Button) */
            .toggle-tool-btn {
                position: fixed; bottom: 20px; right: 20px; top: auto; left: auto;
                width: 60px; height: 60px; border-radius: 50%;
                writing-mode: horizontal-tb;
                background: #000; border: 2px solid #00ff00; color: #00ff00;
                z-index: 200; box-shadow: 0 0 15px #00ff00;
            }
            .toggle-tool-btn::after { content: "ü§ñ"; font-size: 24px; }
            /* ·∫®n ch·ªØ m·∫∑c ƒë·ªãnh c·ªßa n√∫t toggle n·∫øu c√≥ */
            .toggle-tool-btn span { display: none; }
        }

        /* Desktop Toggle Logic */
        @media (min-width: 769px) {
            .tool-panel.collapsed {
                margin-right: -320px; /* Thu v√†o b√™n ph·∫£i */
            }
            .toggle-tool-btn::after { content: "TOOLS"; transform: rotate(180deg); }
        }

    </style>
</head>
<body>

    <div class="app-container">
        <div class="game-area">
            <div class="balance-bar" id="balanceDisplay">10,000,000</div>
            <div id="winMsg" class="win-msg">H√öP TO!</div>

            <div class="board">
                <div class="gate" id="gateTai" onclick="selectGate('TAI')">
                    <div class="gate-title txt-tai">T√ÄI</div>
                    <div style="font-size:10px; color:#aaa">11-17</div>
                    <div class="my-bet" id="betTaiDisplay">0</div>
                </div>

                <div class="plate">
                    <div class="timer" id="timer">15</div>
                    <div class="dice-grp">
                        <div class="dice" id="d1">?</div>
                        <div class="dice" id="d2">?</div>
                        <div class="dice" id="d3">?</div>
                    </div>
                    <div class="bowl" id="bowl">
                        <span style="font-size:30px; font-weight:900; opacity:0.3; color:black">VIP</span>
                    </div>
                </div>

                <div class="gate" id="gateXiu" onclick="selectGate('XIU')">
                    <div class="gate-title txt-xiu">X·ªàU</div>
                    <div style="font-size:10px; color:#aaa">4-10</div>
                    <div class="my-bet" id="betXiuDisplay">0</div>
                </div>
            </div>

            <div class="controls">
                <div class="status" id="statusText">Vui l√≤ng ƒë·∫∑t c∆∞·ª£c</div>
                <div class="chips">
                    <div class="chip" onclick="addChip(100000)">100K</div>
                    <div class="chip" onclick="addChip(500000)">500K</div>
                    <div class="chip" onclick="addChip(1000000)">1M</div>
                    <div class="chip" onclick="addChip(5000000)">5M</div>
                    <div class="chip" style="background: #e74c3c; border-color:red" onclick="resetBet()">X√ìA</div>
                </div>
                <button class="btn-confirm" id="btnConfirm" onclick="confirmBet()">X√ÅC NH·∫¨N C∆Ø·ª¢C</button>
            </div>

            <div class="roadmap" id="roadMap">
                </div>
        </div>

        <button class="toggle-tool-btn" onclick="toggleTool()"><span></span></button>
        
        <div class="tool-panel" id="toolPanel">
            <div style="position:absolute; top:5px; right:10px; color: #555; cursor:pointer" onclick="toggleTool()">[X]</div>
            <div class="tool-header">SYSTEM HACK V3.0</div>
            
            <div class="log-box" id="consoleLog">
                <div>> Connected to Server...</div>
                <div>> Ready.</div>
            </div>

            <div class="result-box">
                <div style="font-size:10px; color:#666">NEXT RESULT</div>
                <div class="res-text" id="hackResult">---</div>
                <div style="font-size:12px; color:#fff" id="hackPercent">T·ªâ l·ªá: --%</div>
            </div>

            <button class="tool-btn" id="btnHack" onclick="runHack()">PH√ÇN T√çCH K·∫æT QU·∫¢</button>
            <button class="tool-btn" id="btnAuto" onclick="runAutoBet()">AUTO V√ÄO TI·ªÄN</button>
        </div>
    </div>

    <script>
        /* --- CORE VARIABLES --- */
        let balance = 10000000;
        let currentBet = 0;
        let selectedSide = null; // 'TAI' or 'XIU'
        let confirmedSide = null;
        let confirmedAmount = 0;
        
        let gameState = 'WAITING'; // WAITING, BETTING, SHAKING, RESULT
        let timeLeft = 15;
        let timerId = null;
        let history = []; // {type: 'TAI', val: 12}
        
        // Tool vars
        let botPrediction = null;

        const diceIcons = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];

        /* --- UI HELPERS --- */
        const el = (id) => document.getElementById(id);
        const fmt = (n) => n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        const log = (msg) => {
            const b = el('consoleLog');
            b.innerHTML += `<div>> ${msg}</div>`;
            b.scrollTop = b.scrollHeight;
        };

        /* --- GAME ENGINE --- */
        function initGame() {
            // FIX L·ªñI: X√≥a interval c≈© tr∆∞·ªõc khi t·∫°o m·ªõi ƒë·ªÉ tr√°nh ch·∫°y ƒë√®
            if (timerId) clearInterval(timerId);

            gameState = 'BETTING';
            timeLeft = 15; // Set 15 gi√¢y theo y√™u c·∫ßu
            
            // Reset UI
            el('bowl').classList.remove('open');
            el('winMsg').style.display = 'none';
            el('statusText').innerText = "B·∫ÆT ƒê·∫¶U ƒê·∫∂T C∆Ø·ª¢C";
            el('statusText').style.color = "#f39c12";
            el('btnConfirm').disabled = false;
            el('btnHack').disabled = false;
            el('btnAuto').disabled = false;
            
            // Reset Bet Data
            currentBet = 0;
            selectedSide = null;
            confirmedSide = null;
            confirmedAmount = 0;
            el('betTaiDisplay').innerText = "0";
            el('betXiuDisplay').innerText = "0";
            el('gateTai').classList.remove('active');
            el('gateXiu').classList.remove('active');
            
            // Reset Tool UI
            el('hackResult').innerText = "---";
            el('hackResult').className = "res-text";
            botPrediction = null;

            log("--- NEW SESSION STARTED ---");

            // Countdown Loop
            el('timer').innerText = timeLeft;
            timerId = setInterval(() => {
                timeLeft--;
                el('timer').innerText = timeLeft;

                if (timeLeft <= 5) el('timer').style.color = "red";
                else el('timer').style.color = "#e74c3c";

                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    startShaking();
                }
            }, 1000);
        }

        function startShaking() {
            gameState = 'SHAKING';
            el('statusText').innerText = "ƒêANG L·∫ÆC... NG∆ØNG C∆Ø·ª¢C";
            el('statusText').style.color = "red";
            el('btnConfirm').disabled = true;
            el('btnHack').disabled = true;
            el('btnAuto').disabled = true;

            el('bowl').classList.add('shaking');
            
            setTimeout(() => {
                el('bowl').classList.remove('shaking');
                showResult();
            }, 2000);
        }

        function showResult() {
            gameState = 'RESULT';
            
            // Random Logic
            const d1 = Math.floor(Math.random() * 6) + 1;
            const d2 = Math.floor(Math.random() * 6) + 1;
            const d3 = Math.floor(Math.random() * 6) + 1;
            const total = d1 + d2 + d3;
            const type = (total >= 11 && total <= 17) ? 'TAI' : 'XIU';

            // Render
            el('d1').innerText = diceIcons[d1-1];
            el('d2').innerText = diceIcons[d2-1];
            el('d3').innerText = diceIcons[d3-1];
            
            el('bowl').classList.add('open');
            el('statusText').innerText = `K·∫æT QU·∫¢: ${total} - ${type}`;
            el('statusText').style.color = "#00ff00";

            // Check Win/Lose
            if (confirmedSide === type) {
                const winMoney = confirmedAmount * 2;
                balance += winMoney;
                el('winMsg').innerText = `+${fmt(winMoney)}`;
                el('winMsg').style.display = 'block';
                log(`Winner: ${type}. B·∫°n th·∫Øng ${fmt(winMoney)}`);
            } else if (confirmedAmount > 0) {
                log(`Result: ${type}. B·∫°n thua ${fmt(confirmedAmount)}`);
            }

            el('balanceDisplay').innerText = fmt(balance);

            // Update History
            history.push({type: type, val: total});
            if(history.length > 15) history.shift();
            renderHistory();

            // Next game in 5s
            setTimeout(initGame, 5000);
        }

        /* --- USER ACTIONS --- */
        function selectGate(side) {
            if (gameState !== 'BETTING' || confirmedSide) return;
            selectedSide = side;
            
            // Visual Update
            el('gateTai').classList.remove('active');
            el('gateXiu').classList.remove('active');
            if(side === 'TAI') el('gateTai').classList.add('active');
            if(side === 'XIU') el('gateXiu').classList.add('active');
            
            // Reset temp bet if switching side
            currentBet = 0;
            updateBetUI();
        }

        function addChip(amount) {
            if (gameState !== 'BETTING') return;
            if (!selectedSide) { alert("Ch·ªçn c·ª≠a T√ÄI ho·∫∑c X·ªàU tr∆∞·ªõc!"); return; }
            if (balance - confirmedAmount - currentBet < amount) { alert("H·∫øt ti·ªÅn!"); return; }

        
