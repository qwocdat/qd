<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sunwin Final Fix</title>
    <style>
        /* --- 1. CSS C∆† B·∫¢N --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body {
            margin: 0; padding: 0;
            background: #0f0f0f; color: #fff;
            font-family: Arial, sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* --- 2. M√ÄN H√åNH CH·ªú (START SCREEN) --- */
        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }
        #btn-start-game {
            padding: 15px 40px; background: #f1c40f; border: none;
            font-size: 22px; font-weight: bold; border-radius: 50px;
            color: #000; cursor: pointer;
            box-shadow: 0 0 20px #f1c40f;
            animation: pulse 1s infinite;
        }
        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }

        /* --- 3. GIAO DI·ªÜN CH√çNH --- */
        .app { display: none; flex-direction: column; height: 100%; width: 100%; } /* ·∫®n m·∫∑c ƒë·ªãnh */
        
        .header {
            height: 50px; background: #1a1a1a; border-bottom: 2px solid #d4af37;
            display: flex; align-items: center; justify-content: center;
        }
        .balance-box {
            color: #f1c40f; font-weight: bold; font-size: 18px;
            border: 1px solid #d4af37; padding: 5px 20px; border-radius: 15px;
            background: #000;
        }

        .game-board {
            flex: 1; background: radial-gradient(#3a0e0e, #000);
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; position: relative;
        }

        /* B√†n c∆∞·ª£c */
        .table-row { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        
        .gate {
            width: 130px; height: 130px;
            background: #2c0505; border: 2px solid #5c1818; border-radius: 10px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: 0.2s;
        }
        .gate.active { border-color: #f1c40f; box-shadow: 0 0 15px #f1c40f; transform: scale(1.05); }
        .gate-title { font-size: 30px; font-weight: 900; color: #fff; }
        .gate-bet { color: #2ecc71; font-weight: bold; margin-top: 5px; font-size: 14px; }

        /* ƒêƒ©a x√≥c */
        .plate {
            width: 160px; height: 160px; border-radius: 50%;
            border: 5px solid #d4af37; position: relative;
            background: #251600;
            display: flex; justify-content: center; align-items: center;
        }
        .timer {
            position: absolute; top: -20px; background: #000;
            color: red; border: 2px solid red; width: 40px; height: 40px;
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-weight: bold; font-size: 18px; z-index: 10;
        }
        .dice-wrap { display: flex; gap: 5px; }
        .dice {
            width: 35px; height: 35px; background: #fff; color: #c0392b;
            border-radius: 5px; font-size: 24px;
            display: flex; justify-content: center; align-items: center;
        }
        .bowl {
            position: absolute; width: 100%; height: 100%; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #f1c40f, #8a6d3b);
            z-index: 5; transition: transform 0.5s, opacity 0.5s;
            box-shadow: 0 5px 15px #000;
        }
        .bowl.open { transform: translateY(-100px); opacity: 0; pointer-events: none; }
        
        /* Hi·ªáu ·ª©ng rung */
        .shaking { animation: shake 0.5s infinite; }
        @keyframes shake { 0% {transform: translate(0,0);} 25% {transform: translate(-3px,3px);} 75% {transform: translate(3px,-3px);} }

        /* Controls */
        .controls { padding: 10px; width: 100%; display: flex; flex-direction: column; gap: 10px; align-items: center; background: #111; }
        .chips { display: flex; gap: 10px; }
        .chip {
            width: 50px; height: 50px; border-radius: 50%;
            background: orange; border: 2px dashed #fff;
            display: flex; justify-content: center; align-items: center;
            color: #fff; font-weight: bold; font-size: 11px;
        }
        .btn-main {
            width: 80%; padding: 12px; background: #f1c40f; border: none;
            font-weight: bold; font-size: 18px; border-radius: 25px;
        }
        .btn-main:disabled { background: #555; color: #888; }
        #status-msg { height: 20px; color: #f39c12; font-weight: bold; }

        /* Tool */
        #tool-btn {
            position: fixed; bottom: 80px; right: 20px;
            width: 50px; height: 50px; background: #000; border: 2px solid #0f0;
            color: #0f0; border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-size: 24px; box-shadow: 0 0 10px #0f0; z-index: 100;
        }
        #tool-panel {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 250px;
            background: #000; border-top: 2px solid #0f0;
            padding: 20px; font-family: monospace; display: none; z-index: 200;
            flex-direction: column; align-items: center;
        }
        .tool-active { display: flex !important; animation: slideUp 0.3s; }
        @keyframes slideUp { from {transform: translateY(100%);} to {transform: translateY(0);} }

    </style>
</head>
<body>

    <div id="start-screen">
        <h1 style="color:#f1c40f">SUNWIN VIP</h1>
        <button id="btn-start-game">B·∫§M ƒê·ªÇ CH∆†I</button>
        <p style="color:#666; font-size: 12px; margin-top:20px">Phi√™n b·∫£n V5 - Safe Mode</p>
    </div>

    <div class="app" id="app-container">
        <div class="header">
            <div class="balance-box" id="balance">10,000,000</div>
        </div>

        <div class="game-board">
            <div style="position: absolute; top: 10%; font-size: 40px; color: yellow; display: none; z-index: 50; text-shadow: 0 0 10px red;" id="win-msg">TH·∫ÆNG L·ªöN!</div>

            <div class="table-row">
                <div class="gate" id="gate-tai">
                    <div class="gate-title">T√ÄI</div>
                    <div class="gate-bet" id="bet-tai">0</div>
                </div>

                <div class="plate">
                    <div class="timer" id="timer">15</div>
                    <div class="bowl" id="bowl"></div>
                    <div class="dice-wrap">
                        <div class="dice" id="d1">1</div>
                        <div class="dice" id="d2">2</div>
                        <div class="dice" id="d3">3</div>
                    </div>
                </div>

                <div class="gate" id="gate-xiu">
                    <div class="gate-title">X·ªàU</div>
                    <div class="gate-bet" id="bet-xiu">0</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <div id="status-msg">Vui l√≤ng ƒë·∫∑t c∆∞·ª£c</div>
            <div class="chips">
                <div class="chip" data-val="100000">100K</div>
                <div class="chip" data-val="500000">500K</div>
                <div class="chip" data-val="1000000">1M</div>
                <div class="chip" data-val="reset" style="background:red">H·ª¶Y</div>
            </div>
            <button class="btn-main" id="btn-confirm">X√ÅC NH·∫¨N</button>
        </div>
    </div>

    <div id="tool-btn">ü§ñ</div>
    <div id="tool-panel">
        <div style="width:100%; text-align:right; color:#fff; font-size:20px;" id="close-tool">‚úï</div>
        <div style="color:#0f0; margin-bottom:10px;">AI HACKER SYSTEM</div>
        <div style="font-size:30px; font-weight:bold; color:#fff" id="tool-result">---</div>
        <button id="btn-hack" style="margin-top:20px; width:100%; padding:10px; background:none; border:1px solid #0f0; color:#0f0">PH√ÇN T√çCH</button>
        <button id="btn-auto" style="margin-top:10px; width:100%; padding:10px; background:#0f0; border:none; color:#000; font-weight:bold">AUTO C∆Ø·ª¢C</button>
    </div>

    <script>
        // ƒê·∫∑t to√†n b·ªô code trong window.onload ƒë·ªÉ ƒê·∫¢M B·∫¢O HTML ƒë√£ t·∫£i xong
        window.onload = function() {
            try {
                // --- 1. KHAI B√ÅO BI·∫æN ---
                let balance = 10000000;
                let gameState = 'STOP'; // STOP, BETTING, SHAKING, RESULT
                let timeLeft = 15;
                let timerInterval = null;
                
                let selectedSide = null; // 'TAI' or 'XIU'
                let tempBet = 0;
                let confirmedBet = 0;
                let confirmedSide = null;
                let aiPrediction = null;

                const diceChars = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];

                // --- 2. L·∫§Y DOM ELEMENT ---
                const uiStart = document.getElementById('start-screen');
                const uiApp = document.getElementById('app-container');
                const btnStart = document.getElementById('btn-start-game');
                
                const elBalance = document.getElementById('balance');
                const elTimer = document.getElementById('timer');
                const elStatus = document.getElementById('status-msg');
                const elBowl = document.getElementById('bowl');
                const elWinMsg = document.getElementById('win-msg');
                const btnConfirm = document.getElementById('btn-confirm');
                
                const gateTai = document.getElementById('gate-tai');
                const gateXiu = document.getElementById('gate-xiu');
                const txtBetTai = document.getElementById('bet-tai');
                const txtBetXiu = document.getElementById('bet-xiu');

                // Tool Elements
                const toolBtn = document.getElementById('tool-btn');
                const toolPanel = document.getElementById('tool-panel');
                const closeTool = document.getElementById('close-tool');
                const btnHack = document.getElementById('btn-hack');
                const btnAuto = document.getElementById('btn-auto');
                const toolResult = document.getElementById('tool-result');

                // --- 3. X·ª¨ L√ù S·ª∞ KI·ªÜN (EVENT LISTENERS) ---
                
                // N√∫t B·∫Øt ƒê·∫ßu (QUAN TR·ªåNG NH·∫§T)
                btnStart.addEventListener('click', function() {
                    uiStart.style.display = 'none';
                    uiApp.style.display = 'flex';
                    initGame(); // B·∫Øt ƒë·∫ßu v√°n m·ªõi
                });

                // Ch·ªçn C·ª≠a T√†i
                gateTai.addEventListener('click', function() { selectSide('TAI'); });
                gateXiu.addEventListener('click', function() { selectSide('XIU'); });

                // Ch·ªçn Chip (Ti·ªÅn)
                document.querySelectorAll('.chip').forEach(chip => {
                    chip.addEventListener('click', function() {
                        let val = this.getAttribute('data-val');
                        if (val === 'reset') {
                            if (!confirmedSide) {
                                tempBet = 0;
                                updateUI();
                            }
                        } else {
                            addChip(parseInt(val));
                        }
                    });
                });

                // N√∫t X√°c Nh·∫≠n
                btnConfirm.addEventListener('click', confirmBet);

                // Tool Logic
                toolBtn.addEventListener('click', () => { toolPanel.classList.add('tool-active'); });
                closeTool.addEventListener('click', () => { toolPanel.classList.remove('tool-active'); });
                
                btnHack.addEventListener('click', function() {
                    if(gameState !== 'BETTING') return;
                    btnHack.innerText = "ƒêang qu√©t...";
                    setTimeout(() => {
                        aiPrediction = Math.random() > 0.5 ? 'TAI' : 'XIU';
                        toolResult.innerText = aiPrediction;
                        toolResult.style.color = aiPrediction === 'TAI' ? '#e74c3c' : '#3498db';
                        btnHack.innerText = "PH√ÇN T√çCH";
                    }, 1000);
                });

                btnAuto.addEventListener('click', function() {
                    if(!aiPrediction) { alert("Ph√¢n t√≠ch tr∆∞·ªõc!"); return; }
                    if(confirmedSide) return;
                    
                    toolPanel.classList.remove('tool-active'); // ƒê√≥ng tool
                    selectSide(aiPrediction);
                    addChip(500000); // 500k
                    setTimeout(confirmBet, 500);
                });


                // --- 4. LOGIC GAME ---

                function initGame() {
                    clearInterval(timerInterval);
                    gameState = 'BETTING';
                    timeLeft = 15;
                    selectedSide = null;
                    tempBet = 0;
                    confirmedBet = 0;
                    confirmedSide = null;
                    aiPrediction = null;

                    // Reset Giao di·ªán
                    elBowl.classList.remove('open');
                    elBowl.classList.remove('shaking');
                    elWinMsg.style.display = 'none';
                    elStatus.innerText = "M·ªúI ƒê·∫∂T C∆Ø·ª¢C";
                    elStatus.style.color = "#f39c12";
                    btnConfirm.disabled = false;
                    
                    gateTai.classList.remove('active');
                    gateXiu.classList.remove('active');
                    txtBetTai.innerText = "0";
                    txtBetXiu.innerText = "0";
                    toolResult.innerText = "---";

                    elTimer.innerText = timeLeft;
                    
                    // ƒê·∫øm ng∆∞·ª£c
                    timerInterval = setInterval(() => {
                        timeLeft--;
                        elTimer.innerText = timeLeft;
                        if (timeLeft <= 0) {
                            clearInterval(timerInterval);
                            startShaking();
                        }
                    }, 1000);
                }

                function startShaking() {
                    gameState = 'SHAKING';
                    elStatus.innerText = "ƒêANG L·∫ÆC...";
                    elStatus.style.color = "red";
                    btnConfirm.disabled = true;
                    elBowl.classList.add('shaking');
                    
                    setTimeout(() => {
                        elBowl.classList.remove('shaking');
                        showResult();
                    }, 2000);
                }

                function showResult() {
                    gameState = 'RESULT';
                    
                    // Random k·∫øt qu·∫£
                    let r1 = Math.floor(Math.random() * 6) + 1;
                    let r2 = Math.floor(Math.random() * 6) + 1;
                    let r3 = Math.floor(Math.random() * 6) + 1;
                    let total = r1 + r2 + r3;
                    let type = (total >= 11 && total <= 17) ? 'TAI' : 'XIU';

                    // Hi·ªÉn th·ªã x√∫c x·∫Øc
                    document.getElementById('d1').innerText = diceChars[r1-1];
                    document.getElementById('d2').innerText = diceChars[r2-1];
                    document.getElementById('d3').innerText = diceChars[r3-1];

                    elBowl.classList.add('open');
                    elStatus.innerText = `K·∫æT QU·∫¢: ${total} - ${type}`;
                    elStatus.style.color = "#0f0";

                    // T√≠nh ti·ªÅn
                    if (confirmedSide === type) {
                        let win = confirmedBet * 2;
                        balance += win;
                        elWinMsg.innerText = `+${formatMoney(win)}`;
                        elWinMsg.style.display = 'block';
                    }

                    updateUI();
                    
                    // V√°n m·ªõi sau 5s
                    setTimeout(initGame, 5000);
                }

                function selectSide(side) {
                    if (gameState !== 'BETTING' || confirmedSide) return;
                    selectedSide = side;
                    tempBet = 0; // Reset ti·ªÅn c∆∞·ª£c t·∫°m th·ªùi khi ƒë·ªïi c·ª≠a
                    updateUI();
                }

                function addChip(amount) {
                    if (gameState !== 'BETTING') return;
                    if (!selectedSide) { alert("Vui l√≤ng ch·ªçn T√ÄI ho·∫∑c X·ªàU tr∆∞·ªõc!"); return; }
                    if (balance - confirmedBet - tempBet < amount) { alert("Kh√¥ng ƒë·ªß ti·ªÅn!"); return; }
                    
                    tempBet += amount;
                    updateUI();
                }

                function confirmBet() {
                    if (tempBet <= 0) return;
                    balance -= tempBet;
                    confirmedBet = tempBet;
                    confirmedSide = selectedSide;
                    
                    elStatus.innerText = "ƒê√É ƒê·∫∂T C∆Ø·ª¢C";
                    btnConfirm.disabled = true;
                    updateUI();
                }

                function updateUI() {
                    elBalance.innerText = formatMoney(balance);
                    
                    // Reset active class
                    gateTai.classList.remove('active');
                    gateXiu.classList.remove('active');
                    
                    if (selectedSide === 'TAI') {
                        gateTai.classList.add('active');
                        txtBetTai.innerText = formatMoney(tempBet);
                        txtBetXiu.innerText = "0";
                    }
                    if (selectedSide === 'XIU') {
                        gateXiu.classList.add('active');
                        txtBetXiu.innerText = formatMoney(tempBet);
                        txtBetTai.innerText = "0";
                    }
                }

                function formatMoney(n) {
                    return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                }

            } catch (err) {
                alert("L·ªói kh·ªüi ch·∫°y game: " + err.message);
            }
        };
    </script>
</body>
</html>
