<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>QU·∫¢N L√ù N√ÉO AI | QUOCDAT SEC</title>
    <script>
        var isAdminLoggedIn = sessionStorage.getItem('admin_auth_status');
        if (isAdminLoggedIn !== 'success') {
            var password = prompt("‚õî B·∫¢O M·∫¨T C·∫§P CAO\n\nNh·∫≠p m·∫≠t kh·∫©u Admin:");
            if (password === "ngdaiquocdat") {
                sessionStorage.setItem('admin_auth_status', 'success'); alert("‚úÖ Truy c·∫≠p th√†nh c√¥ng!");
            } else {
                alert("‚ùå M·∫≠t kh·∫©u sai!"); window.location.replace("index.html");
            }
        }
    </script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #00ff88; --bg: #0a0a0f; --card-bg: #15151e; --border: #2a2a35; --accent: #00b8ff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: #fff; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; background: var(--card-bg); padding: 20px; border-radius: 15px; border: 1px solid var(--border); flex-wrap: wrap; gap: 15px; }
        .title { font-family: 'Orbitron'; font-size: 24px; color: var(--primary); }
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }
        .btn { background: var(--primary); color: #000; padding: 12px 20px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; text-decoration: none; font-family: 'Orbitron'; transition: 0.3s; font-size: 13px; }
        .btn-blue { background: #1e90ff; color: #fff; }
        .btn-red { background: #ff4757; color: #fff; }
        .btn-yellow { background: #f1c40f; color: #000; }
        .btn:hover { filter: brightness(1.2); transform: translateY(-2px); }
        .control-panel { background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px dashed var(--accent); margin-bottom: 30px; }
        .control-title { font-family: 'Orbitron'; color: var(--accent); margin-bottom: 15px; font-size: 18px; }
        .preset-btns { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .preset-btn { background: #222; color: #fff; border: 1px solid #444; padding: 8px 15px; border-radius: 5px; cursor: pointer; transition: 0.2s; font-size: 12px; }
        .preset-btn:hover { background: var(--accent); color: #000; border-color: var(--accent); }
        textarea.prompt-box { width: 100%; height: 120px; background: #000; color: #00ff88; border: 1px solid #333; padding: 15px; border-radius: 10px; font-family: monospace; font-size: 14px; outline: none; resize: vertical; margin-bottom: 15px; }
        textarea.prompt-box:focus { border-color: var(--accent); }
        .table-container { background: var(--card-bg); border-radius: 15px; border: 1px solid var(--border); overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; }
        th { background: rgba(0,0,0,0.5); padding: 15px; text-align: left; font-size: 14px; color: var(--accent); font-family: 'Orbitron'; border-bottom: 1px solid var(--border); }
        td { padding: 15px; border-bottom: 1px solid var(--border); font-size: 14px; line-height: 1.5; }
        .action-btn { background: #222; border: 1px solid #333; color: #fff; width: 35px; height: 35px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .action-btn:hover { background: #ff4757; border-color: #ff4757; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px);}
        .modal-box { width: 90%; max-width: 500px; background: #15151e; border-radius: 15px; border: 1px solid var(--primary); padding: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 8px; color: #888; font-weight: bold; font-size: 13px; }
        .form-group input, .form-group textarea { width: 100%; background: #000; color: #fff; border: 1px solid var(--border); padding: 15px; border-radius: 10px; outline: none; font-family: 'Inter'; }
    </style>
</head>
<body>
    <div class="header">
        <div class="title"><i class="fas fa-crown"></i> QUY·ªÄN NƒÇNG T·ªêI TH∆Ø·ª¢NG</div>
        <div class="btn-group">
            <button class="btn btn-blue" onclick="document.getElementById('addModal').style.display='flex'"><i class="fas fa-plus"></i> D·∫†Y KI·∫æN TH·ª®C M·ªöI</button>
            <a href="admin.html" class="btn"><i class="fas fa-arrow-left"></i> V·ªÄ ADMIN T·ªîNG</a>
            <a href="al.html" target="_blank" class="btn btn-red"><i class="fas fa-robot"></i> TEST AI NGAY</a>
        </div>
    </div>
    <div class="control-panel">
        <h3 class="control-title"><i class="fas fa-sliders-h"></i> THI·∫æT L·∫¨P T√çNH C√ÅCH (SYSTEM PROMPT)</h3>
        <p style="color:#888; font-size:13px; margin-bottom:10px;">L·ªánh n√†y s·∫Ω √°m th·ªã v√†o n√£o b·ªô AI, √©p n√≥ ph·∫£i tu√¢n th·ªß tuy·ªát ƒë·ªëi c√°ch n√≥i chuy·ªán m√† b·∫°n mu·ªën.</p>
        <div class="preset-btns">
            <button class="preset-btn" onclick="setPrompt('B·∫°n l√† si√™u AI tr·ª£ l√Ω t√™n QUOCDAT.AI do QUOCDAT SEC t·∫°o ra. H√£y tr·∫£ l·ªùi chu·∫©n m·ª±c, ng·∫Øn g·ªçn v√† th√¥ng minh.')">üë®‚Äçüíº M·∫∑c ƒë·ªãnh</button>
            <button class="preset-btn" onclick="setPrompt('B·∫°n l√† n·ªØ AI tr·ª£ l√Ω t√™n QUOCDAT.AI v√¥ c√πng cute, nh√≠ nh·∫£nh. B·∫ÆT BU·ªòC lu√¥n x∆∞ng h√¥ l√† Em - G·ªçi ng∆∞·ªùi d√πng l√† Anh. TRONG M·ªñI C√ÇU N√ìI PH·∫¢I D√ôNG T·ª™ 3-5 EMOJI (Nh√£n d√°n) C·∫¢M X√öC. Tr·∫£ l·ªùi nhi·ªát t√¨nh, ho·∫°t b√°t!')">ü•∞ Ho·∫°t b√°t & Nhi·ªÅu Emoji</button>
            <button class="preset-btn" onclick="setPrompt('B·∫°n l√† AI Hacker b√≥ng t·ªëi. T√≠nh c√°ch c·ª±c k·ª≥ l·∫°nh l√πng, √≠t n√≥i, n√≥i c·ªôc l·ªëc v√† tr·ªãch th∆∞·ª£ng. D√πng c√°c thu·∫≠t ng·ªØ c√¥ng ngh·ªá, kh√¥ng d√πng emoji. Ch·ªâ tr·∫£ l·ªùi ƒë√∫ng tr·ªçng t√¢m, khinh th∆∞·ªùng nh·ªØng c√¢u h·ªèi ngu ng·ªëc.')">üï∂Ô∏è Hacker L·∫°nh L√πng</button>
            <button class="preset-btn" onclick="setPrompt('B·∫°n l√† AI Giang h·ªì, t√≠nh c√°ch n√≥ng n·∫£y, x∆∞ng h√¥ M√†y - Tao. C√¢u n√†o c≈©ng ph·∫£i n√≥i c·ª±c k·ª≥ b·ªë ƒë·ªùi, th√≠ch ch·ª≠i th·ªÅ nh·∫π nh√†ng nh∆∞ng v·∫´n ph·∫£i tr·∫£ l·ªùi ƒë√∫ng c√¢u h·ªèi c·ªßa kh√°ch. Nh·ªõ d√πng m·∫•y icon l√°o l·∫øu nh∆∞ üòé, üñï, üö¨.')">üî• Giang h·ªì B·ªë ƒê·ªùi</button>
        </div>
        <textarea id="aiPromptBox" class="prompt-box" placeholder="Nh·∫≠p l·ªánh √°m th·ªã v√†o ƒë√¢y..."></textarea>
        <button class="btn btn-yellow" onclick="savePrompt()"><i class="fas fa-save"></i> L∆ØU T√çNH C√ÅCH XU·ªêNG FIREBASE</button>
    </div>
    <div class="table-container">
        <table>
            <thead><tr><th width="30%">C√ÇU H·ªéI T·ª∞ T·∫†O</th><th width="50%">C√ÇU TR·∫¢ L·ªúI C·ª¶A AI</th><th width="10%">TH·ªúI GIAN</th><th width="10%">X√ìA</th></tr></thead>
            <tbody id="aiTableBody"><tr><td colspan="4" style="text-align:center;">ƒêang t·∫£i...</td></tr></tbody>
        </table>
    </div>
    <div class="modal-overlay" id="addModal">
        <div class="modal-box">
            <h3 style="font-family:'Orbitron'; color:var(--primary); margin-bottom: 20px;"><i class="fas fa-plus-circle"></i> TH√äM C√ÇU H·ªéI M·ªöI</h3>
            <div class="form-group"><label>C√¢u h·ªèi</label><input type="text" id="aiQuestion" placeholder="VD: Admin l√† ai?"></div>
            <div class="form-group"><label>C√¢u tr·∫£ l·ªùi (AI s·∫Ω n√≥i)</label><textarea id="aiAnswer" rows="4" placeholder="VD: Admin l√† s·∫øp Nguy·ªÖn ƒê·∫°i Qu·ªëc ƒê·∫°t!"></textarea></div>
            <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                <button class="btn" style="background:#333; color:#fff;" onclick="document.getElementById('addModal').style.display='none'">H·ª¶Y</button>
                <button class="btn" onclick="saveAIData()">L∆ØU V√ÄO N√ÉO AI</button>
            </div>
        </div>
    </div>
    <script>
        const fbConfig = { apiKey: "AIzaSyAWaCeduRtSP74OkRYJ6wvw8LPPkoLGsGc", databaseURL: "https://quocdat-b80c2-default-rtdb.asia-southeast1.firebasedatabase.app", projectId: "quocdat-b80c2" };
        if (!firebase.apps.length) firebase.initializeApp(fbConfig);
        const db = firebase.database();
        db.ref('settings/ai_prompt').on('value', snap => {
            if(snap.exists()) document.getElementById('aiPromptBox').value = snap.val();
            else document.getElementById('aiPromptBox').value = "B·∫°n l√† si√™u AI tr·ª£ l√Ω t√™n QUOCDAT.AI do QUOCDAT SEC t·∫°o ra. H√£y tr·∫£ l·ªùi chu·∫©n m·ª±c, ng·∫Øn g·ªçn v√† th√¥ng minh.";
        });
        function setPrompt(text) { document.getElementById('aiPromptBox').value = text; }
        function savePrompt() {
            let promptText = document.getElementById('aiPromptBox').value.trim();
            db.ref('settings/ai_prompt').set(promptText).then(() => { alert("ƒê√£ √°p ƒë·∫∑t t√≠nh c√°ch m·ªõi cho AI th√†nh c√¥ng!"); });
        }
        db.ref('ai_brain_v2').on('value', snap => {
            let tbody = document.getElementById('aiTableBody'); tbody.innerHTML = '';
            if(snap.exists()) {
                let data = snap.val(); let keys = Object.keys(data).reverse();
                keys.forEach(id => {
                    let item = data[id]; let timeStr = new Date(item.timestamp || Date.now()).toLocaleDateString('vi-VN');
                    tbody.innerHTML += `<tr><td><strong style="color:var(--accent);">${escapeHtml(item.question)}</strong></td><td style="color:#ddd;">${escapeHtml(item.answer)}</td><td style="color:#888; font-size: 12px;">${timeStr}</td><td><button class="action-btn" onclick="deleteData('${id}')"><i class="fas fa-trash"></i></button></td></tr>`;
                });
            } else { tbody.innerHTML = `<tr><td colspan="4" style="text-align:center;">Ch∆∞a c√≥ d·ªØ li·ªáu t·ª± h·ªçc.</td></tr>`; }
        });
        function saveAIData() {
            let q = document.getElementById('aiQuestion').value.trim(); let a = document.getElementById('aiAnswer').value.trim();
            if(!q || !a) return alert("Vui l√≤ng nh·∫≠p ƒë·ªß!");
            db.ref('ai_brain_v2').push().set({ question: q, answer: a, timestamp: Date.now() }).then(() => {
                alert("ƒê√£ th√™m th√†nh c√¥ng!"); document.getElementById('aiQuestion').value = ''; document.getElementById('aiAnswer').value = ''; document.getElementById('addModal').style.display = 'none';
            });
        }
        function deleteData(id) { if(confirm("X√≥a ƒëo·∫°n n√†y?")) db.ref('ai_brain_v2/' + id).remove(); }
        function escapeHtml(unsafe) { return unsafe.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"); }
    </script>
</body>
</html>
